---

---

### Shell 이란?
---
> [!info]
> 사용자로부터 받은 명령을 kernel이 이해하도록 해석하여 전달하는 명령어 해석기

- 리눅스의 경우
	- /bin/sh : 표준 쉘로 복구 모드에 사용된다.
	- /bin/bash : 리눅스에서 대표적으로 사용하는 쉘

### Shell script
---
>[!info]
>스크립트(파일)에 명령어를 전ㅂ주 적고 한번에 실행되도록 만들 수 있는데 이렇게 만든 파일들을 shell script, batch file이라고 부른다.


### Shell script 배치파일을 만들려는 이유
---
가장 큰 이유는 해보지 않았기 때문이다.
생각만 해보고 하지 않다가 찾아보게 된 계기도 물론 있다.

회사에서 개발중인 프로젝트가 있는데 현재 개발중이라 DB가 보다 자유롭게 변하고 있다. 작업자가 여러명이기 때문에 DB의 일관성을 유지하고자 하나의 DB를 모두가 바라보는 상태였다. 그 상태에서 해당 DB가 날리는 실수를 하게 되었다. 

백업해둔 파일이 있어 금방 복구했지만 시제품이 나오기 전까지 계속해서 변화하는 DB를 하루 단위로 백업을 시켜야 할 필요성을 느꼈다.

그래서 간단히 쉘스크립트로 DB를 백업하여 개발서버에서 로컬 PC로 전송까지를 생각하고 있다.


### Shell script 만드는 방법 (Linux)
---
1. 리눅스의 경우 상단에 명령어르ㅜㄹ 해석할 때 사용할 쉘을 표기해야한다.
```bash
#!/bin/sh

echo 'hello, world'
python test.py
```
2. 리눅스 쉘에서 사용하는 명령어를 줄별로 입력하고
3. 파일 확장자 명을 .sh로 저장한다.

### 스케쥴링
---
위 단계를 거치면 내가 원하는 코드는
``` bash
echo 'DB backup'
psql -U postgres -d database /opt/file_nm.sql
```
로 간단히 구현이 가능하다.  하지만 내가 원하는 것은 모두가 퇴근한 이후 하루에 한번 특정 시간에 파일을 실행하는 것이다.

#### 크론탭
>[!info]
>리눅스는 크론탭, 윈도우는 스케줄러
>특정 시간에 작업을 하기 위한 명령어가 존재했다.

#### 크론탭 사용법
1. 크론탭 편집기 열기
```bash
crontab -e
```
2. 크론탭에 설정된 리스트 확인하기
```bash
crontab -l
```
3. 크론탭 지우기
```bash
crontab -r
```

#### 주기 설정
```
*         *         *        *        *
분(0-59) 시간(0-23) 일(1-31) 월(1-12) 요일(0-7) 0과 7은 일요일
```
예제
```bash
0 0 * * * /opt/test.sh
```
#### 크론 로깅
로그를 찍고 싶을 땐 로그를 작성할 파일 위치를 입력해주면 된다.
예제
```bash
0 0 * * * /opt/test.sh >> /opt/test.log 2>&1
```

#linux
#crontab
