#  ~ 현재까지의 화면
---
현재까지는 화면에 그리드와 표, 차트 컴포넌트 등이 나열되어 있었지만 새로운 프로젝트들은 접고 열고 옆으로 돌리는 등 애니메이션이 추가되고 있습니다.

올해가 들어서 화면쪽을 개발하다보니 가장 큰 스트레스는 화면 디자인이었습니다. 

> [!caution] 계속 되는 반복작업
> 작업 -> 수정 -> 작업 -> 수정 -> 완료 -> 디자인 수정->  다시 작업

단순히 html의 레이아웃만 변하는 것도 스트레스 받는데, 데이터에 따라 동적으로 반복해서 그리는 작업을 할 때면, html의 영역을 Javascript에서 만들어서 쓰는데 그러면 **디자이너와의 협업**이 힘들었습니다.  그 원인을 생각해봤더니 다음과 같은 원인이 있었습니다.

## 문제점
---
#### 1. html 코드와 js 코드의 혼재
첫번째 문제는 js 코드와 html 코드의 혼재에 있었습니다. 여기엔 두 가지 측면이 문제였는데

1. 화면을 만들어 갈 때, 맨 위 혹은 맨 아래와 JS 코드를 왔다갔다 하는 번거로움
2. 기능을 개발하는 동안엔 코드의 충돌 때문에 파일을 수정할 수 없다.


#### 2. mako template 예약어로 인한 리터럴 템플릿 사용불가
가독성을 위해서 html을 JS에서 작성하는 코드를 만들 때, 탭을 추가하는데 새로운 요소가 생기거나, 겉을 감싸주는 div가 늘어나면 모든 라인에 tab을 해줘야하지만 '+' 가 있어서 빈 공간을 찍고 탭을 눌렀어야 했습니다.
```javascript
var html = "<div>"
+             "hello"         <- hello와 world 사이에 div가 추가 되면 +와 ""사이를 클릭하고 탭을 한다.
+             "world"
+           "</div>"
```

#### 3 JavaScript로 화면 템플릿 그리기
두번째 문제는 JS 코드로 화면을 그리면 화면은 어찌 변경할 수 있지만 디자이너가 수정이 힘들다는 점입니다. 
단순히 div를 넣거나 버튼을 넣는 것은 큰 문제가 되지 않지만 복잡화면은 반드시 디자이너가 다시 수정하기 때문입니다.

```html
<script>
	... <- 여기에 html 그리기 코드
</script>
<div></div> <- 디자이너가 찾고 있는 부분
```


>[!question] 문의
>디자이너 : 어디서 바꾸지? (처음 html에 해당 화면이 없을 때)
>디자이너 : 색을 어떻게 바꾸지? (색이 동적으로 바뀔 때)
>디자이너 : 바꿔도 되는 건가? (변경부분을 찾았을 때)
>개발자 : 이거 어떻게 구성하지 ? (처음 화면설계도를 받았을 때)
>개발자 : 이거 클래스 변경되면 화면 깨질텐데 (스타일을 내맘대로 만들기 위해 클래스를 얼기설기 사용할 때)
>개발자 : 아 html 다시 그리고 변수 넣어야 겠네 (디자인이 변경되어 화면을 다시 그려야 할 때)


## 현재 프로젝트에 사용한 방안
---
#### 1. html과 js의 분리
아직 디자이너와의 협업이 시작되지 않은 상태이지만, 현재 아래와 같이 파일을 나눠놔서 만약 디자인 수정과 로직 수정이 필요하다면 디자이너는 html만 있는 파일, 개발자는 js가 몰려있는 파일을 수정할 수 있습니다.
```file system
template/
	- xxx_home.html  (css/html)
	- xxx_home_js.html (js)
```

#### 2. mako 템플릿의 <%text></%text>
해당 태그를 사용하면 태그가 시작된 부분부터 태그가 끝나는 곳까지 ${variable}을 사용할 수 있습니다.

```javascript
var b = "abc";
var a = `
	<div> ${b} </div>
`;
```
> 스코프를 따지면 <%text>태그가 있으면 js영역, 없으면 page 영역

딱 필요한 부분만 <%text> 태그로 감싸서 사용하다가 ${app_name}을 더 이상 사용하지 않음으로써 document.ready 이후부터 html이 나오기 전까지 감싸서 개발하고 있습니다.

```javascript
var gb_a = ${a};
var gb_b = ${b};
document.ready(function(){
	/===
})
<%text>
    /===>  자바스크립트 영역
</%text>
<div>
	/====> html 영역
</div>
```

#### 3. html의 템플릿화
화면을 동적으로 그리는 것은 2번으로 해결하기도 했지만, 문제는 디자이너가 수정하기 어렵다는 점이 있었습니다. 복사해서 쓰려고 해오 안에 ${variable} 코드가 있기 때문에 mako템플릿에서 불러올 때 에러가 발생할 수 있다는 점에서도 그랬습니다. 그에 대한 방법으로 아래와 같은 코드를 찾았습니다.

```html
<script type="text/html" id="template1" >
	<div></div>
</script>
```

바로 script 태그로 html 태그를 감싼 형태입니다. 스크립트로 되어 있기 때문에 화면에 표시되지 않을 뿐더러  id를 설정할 수 있어 원하는 html 템플릿을 원하는 곳에서 읽어서 사용할 수 있었습니다.
변수 설정은 다음과 같이 했습니다.

```html
<%text>
	var a = $("#template1").html();
	var obj = { 'abc' : 'hello'};

	var keyList = Object.keys(obj) // ['abc'];
	keyList.map((k)=>{
		var regExp = new RegExp('{{'+ k+'}}', "gi");
		a = a.replaceAll(regExp, obj[k]);
	})
	$("#container").html(a);
	
</%text>
<div id="container"> // html 영역
</div>
<script type="text/html" id="template1"> //템플릿
	<div id={{abc}}>
</script>
```


## 마치면서
---
#### 1. 이에 대한 의견 피드백
#### 2. 문제점에 대한 의견
- dataset

#template
#html
#js 